//Mandrel and Allargatore
//Pozzeto side
//Toolpath Creation for Spine
FUNCTION SPINE_POZZETO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		//SGR Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D12 DRILL       2         T228"
		STRING $SMUSSO      = "SPINE POZZETO D12 SMUSSO      1         T806"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Spine\D12\SPINE POZZETO D12 SGR.ptf"
	} ELSE {
		
		//FINtf Procedure              Toolpath            Index  Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D12 DRILL       2         T238"
		STRING $PREFIN      = "SPINE POZZETO D12 PREFIN      2         T966"
		STRING $SMUSSO      = "SPINE POZZETO D12 SMUSSO      1         T806"
		STRING $SEMIFIN     = "SPINE POZZETO D12 SEMIFIN     2         T973"
		STRING $FIN         = "SPINE POZZETO D12 FIN         2         T973"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Spine\D12\SPINE POZZETO D12 FINTF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_POZZETO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	
	//List the Toolpaths
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		//SGR Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D16 DRILL       2         T240"
		STRING $SMUSSO      = "SPINE POZZETO D16 SMUSSO      1         T369"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Spine\D16\SPINE POZZETO D16 SGR.ptf"
	} ELSE {
		
		//FINtf Procedure              Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE POZZETO D16 DRILL       2         T238"
		STRING $PREFIN      = "SPINE POZZETO D16 PREFIN      2         T966"
		STRING $SMUSSO      = "SPINE POZZETO D16 SMUSSO      1         T806"
		STRING $SEMIFIN     = "SPINE POZZETO D16 SEMIFIN     2         T983"
		STRING $FIN         = "SPINE POZZETO D16 FIN         2         T983"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Spine\D16\SPINE POZZETO D16 FINTF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Viti
FUNCTION VITI_POZZETO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI POZZETO M12 DRILL        2         T228"
	STRING $SMUSSO      = "VITI POZZETO M12 SMUSSO       1         T369"
	STRING $MASCHIO     = "VITI POZZETO M12 MASCHIO      2         T702"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Viti\M12\VITI POZZETO M12.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_POZZETO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI POZZETO M16 DRILL        2         T238"
	STRING $SMUSSO      = "VITI POZZETO M16 SMUSSO       1         T369"
	STRING $MASCHIO     = "VITI POZZETO M16 MASCHIO      2         T704"
	$TOOLPATHS = {$DRILL , $SMUSSO , $MASCHIO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Viti\M16\VITI POZZETO M16.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "264" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Workplane
		ACTIVATE WORKPLANE $WP_POZZETO
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_POZZETO_M16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Matrice and Piana
//Camera side
//Toolpath Creation for Spine
FUNCTION SPINE_CAMERA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $PIANA AND $MANUAL_ALLIGN {
		//SCA Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D12 DRILL        2         T235"
		STRING $SMUSSO      = "SPINE CAMERA D12 SMUSSO       1         T369"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Camera\Spine\D12\SPINE CAMERA D12 SCA.ptf"
	} ELSE {
		
		//FINsf Procedure              Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D12 DRILL        2         T228"
		STRING $PREFIN      = "SPINE CAMERA D12 PREFIN       2         T965"
		STRING $SMUSSO      = "SPINE CAMERA D12 SMUSSO       1         T806"
		STRING $SEMIFIN     = "SPINE CAMERA D12 SEMIFIN      2         T972"
		STRING $FIN         = "SPINE CAMERA D12 FIN          2         T803"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Camera\Spine\D12\SPINE CAMERA D12 FINSF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_CAMERA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $PIANA AND $MANUAL_ALLIGN {
		//SCA Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D16 DRILL        2         T235"
		STRING $SMUSSO      = "SPINE CAMERA D16 SMUSSO       1         T369"
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Camera\Spine\D16\SPINE CAMERA D16 SCA.ptf"
	} ELSE {
		
		//FINsf Procedure              Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE CAMERA D16 DRILL        2         T238"
		STRING $PREFIN      = "SPINE CAMERA D16 PREFIN       2         T966"
		STRING $SMUSSO      = "SPINE CAMERA D16 SMUSSO       1         T806"
		STRING $SEMIFIN     = "SPINE CAMERA D16 SEMIFIN      2         T973"
		STRING $FIN         = "SPINE CAMERA D16 FIN          2         T973"
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Camera\Spine\D16\SPINE CAMERA D16 FINSF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_CAMERA_D16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Toolpath Creation for Viti
FUNCTION VITI_CAMERA_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool    Depth
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI CAMERA M12 DRILL         2         T238      " + $DEPTH
	STRING $SMUSSO      = "VITI CAMERA M12 SMUSSO        1         T369      3"
	$TOOLPATHS = {$DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Camera\Viti\M12\VITI CAMERA M12.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION VITI_CAMERA_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MATRICE , BOOL $PIANA BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT / 2 + 7
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	//FINtf Procedure              Toolpath            Index       Tool    Depth
	//                              10        20        30        40        50
	//                     012345678901234567890123456789012345678901234567890
	STRING $DRILL       = "VITI CAMERA M16 DRILL         2         T242      " + $DEPTH
	STRING $SMUSSO      = "VITI CAMERA M16 SMUSSO        1         T369      3"
	$TOOLPATHS = {$DRILL , $SMUSSO}
	
	//Clear Toolpaths
	FOREACH PACKET IN $TOOLPATHS {
	STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
			DELETE Toolpath $PATHNAME NOQUIBBLE
		}
	}
	
	//Import all toolpaths
	IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Camera\Viti\M16\VITI CAMERA M16.ptf"
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_1"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_2"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_3"
		EDIT FEATURESET $SETNAME SELECT "VITI_CAMERA_M16_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

//Scarico side
//Toolpath Creation for Spine
FUNCTION SPINE_SCARICO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO , BOOL $SPINE_DIFFER) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT - 10
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $FLAT AND $TWOPARTS AND $ALLARGATORE_FIRST AND NOT $COLLARINO_CAMERA {
		//Pack 4 has nothing to drill in scarico
		BREAK
	} ELSEIF $PIANA_FIRST AND $SPINE_ALLIGN {
		//FINtf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T235      " + $DEPTH
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T369      "
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 SCA.ptf"
	} ELSEIF $SPINE_DIFFER {
		//FINsf Procedure              Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T228      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D12 PREFIN      2         T965      "
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T806      "
		STRING $SEMIFIN     = "SPINE SCARICO D12 SEMIFIN     2         T972      "
		STRING $FIN         = "SPINE SCARICO D12 FIN         2         T803      "
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 FINSF.ptf"
	} ELSE {
		//SCA Procedure                Toolpath            Index       Tool    Depth
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T228      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D12 PREFIN      2         T965      "
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T806      "
		STRING $SEMIFIN     = "SPINE SCARICO D12 SEMIFIN     2         T972      "
		STRING $FIN         = "SPINE SCARICO D12 FIN         2         T803      "
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 FINSF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}

FUNCTION SPINE_SCARICO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $PORTHOLE , BOOL $FLAT , BOOL $TWOPARTS , BOOL $THREEPARTS , BOOL $ALLARGATORE_FIRST , BOOL $PIANA_FIRST  , BOOL $MATRICE , BOOL $PIANA , BOOL $COLLARINO_CAMERA , BOOL $COLLARINO_SCARICO  , BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , REAL $MATRICEHEIGHT , STRING $WP_SCARICO) {
	//Variables
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	REAL $SPEED = 0
	REAL $FEED = 0
	REAL $PLUNGE = 0
	REAL $DEPTH =  $MATRICEHEIGHT - 10
	STRING LIST $TOOLPATHS = {}
	EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
	
	//List the Toolpaths
	IF $PIANA AND $MANUAL_ALLIGN {
		//SCA Procedure                Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T235      " + $DEPTH
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T369      "
		$TOOLPATHS = {$DRILL , $SMUSSO}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 SCA.ptf"
	} ELSE {
		
		//FINsf Procedure              Toolpath            Index       Tool
		//                              10        20        30        40        50
		//                     012345678901234567890123456789012345678901234567890
		STRING $DRILL       = "SPINE SCARICO D12 DRILL       2         T228      " + $DEPTH
		STRING $PREFIN      = "SPINE SCARICO D12 PREFIN      2         T965      "
		STRING $SMUSSO      = "SPINE SCARICO D12 SMUSSO      1         T806      "
		STRING $SEMIFIN     = "SPINE SCARICO D12 SEMIFIN     2         T972      "
		STRING $FIN         = "SPINE SCARICO D12 FIN         2         T803      "
		$TOOLPATHS = {$DRILL , $PREFIN , $SMUSSO , $SEMIFIN , $FIN}
		
		//Clear Toolpaths
		FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
			IF ENTITY_EXISTS('Toolpath' , $PATHNAME) {
				DELETE Toolpath $PATHNAME NOQUIBBLE
			}
		}
		
		//Import all toolpaths
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Scarico\Spine\D12\SPINE SCARICO D12 FINSF.ptf"
	}
	
	//Select Solid to ignore it
	BLANK UNDO
	EDIT LEVEL "20" SELECT ALL
	
	//Build the toolpaths
	FOREACH PACKET IN $TOOLPATHS {
		STRING $PATHNAME = RTRIM(SUBSTRING($PACKET , 0 , 29))
		INT $INDEX = SUBSTRING($PACKET , 30 , 1)
		STRING $TOOLNUMBER = SUBSTRING($PACKET , 40 , 4)
		REAL $DRILLDEPTH = SUBSTRING($PACKET , 50 , 4)
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		
		//Drill Toolpath
		ACTIVATE Toolpath $PATHNAME
		//Select Component
		EDIT DRILL TOP_INDEX $INDEX
		EDIT DRILL COMP_INDEX $INDEX
		//Workplane
		ACTIVATE WORKPLANE $WP_SCARICO
		//Depth
		EDIT DRILL DEPTH $DRILLDEPTH
		//Tool
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		//Rapids
		EDIT TOOLPATH SAFEAREA SIZE "2"
		EDIT TOOLPATH SAFEAREA PLUNGE_SIZE  "2"
		//Component Thickness
		EDIT TOOLPATH THICKNESS LIST UPDATE 0 NEW
		EDIT TOOLPATH ; THICKNESS ACQUIRE
		EDIT TOOLPATH ; THICKNESS COMPONENTS IGNORE
		//Select Featureset Components
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_SCARICO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		//Calculate
		EDIT TOOLPATH $PATHNAME CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	}		
	//Deselect Solid
	BLANK UNDO
}
