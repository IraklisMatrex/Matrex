//Mandrel and Allargatore
//Pozzeto side
//Toolpath Creation for Spine
FUNCTION SPINE_POZZETO_D10_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Master Files\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT DRILL PECK_DEPTH $PLUNGE
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}
FUNCTION SPINE_POZZETO_D12_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}
FUNCTION SPINE_POZZETO_D14_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}
FUNCTION SPINE_POZZETO_D16_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}
FUNCTION SPINE_POZZETO_D20_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}
FUNCTION SPINE_POZZETO_D24_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}
FUNCTION SPINE_POZZETO_D30_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}
FUNCTION SPINE_POZZETO_D40_TEMPLATE(STRING $SETNAME , STRING $COMPANY , BOOL $MANDREL , BOOL $ALLARGATORE BOOL $MANUAL_ALLIGN , BOOL $SPINE_ALLIGN , STRING $WP_POZZETO) {
	STRING $TOOLNUMBER = ""
	STRING $NAME = ""
	INT $SPEED = 0
	INT $FEED = 0
	INT $PLUNGE = 0
	
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 DRILL") {
		DELETE Toolpath "SPINE POZZETO D12 DRILL"
	}
	IF ENTITY_EXISTS('Toolpath',"SPINE POZZETO D12 SMUSSO") {
		DELETE Toolpath "SPINE POZZETO D12 SMUSSO"
	}
	
	//SGR and FINtf Procedures
	IF $ALLARGATORE AND $MANUAL_ALLIGN {
		IMPORT TEMPLATE PROJECT FILEOPEN "V:\Matrex\Powermill\Tamplates\Pozzeto\Spine\SPINE POZZETO D12 SGR.ptf"
		ACTIVATE Toolpath "SPINE POZZETO D12 DRILL"
		ACTIVATE WORKPLANE $WP_POZZETO
		$TOOLNUMBER = "T232"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 DRILL" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
		
		ACTIVATE Toolpath "SPINE POZZETO D12 SMUSSO"
		ACTIVATE WORKPLANE $WP_POZZETO
		EDIT DRILL COMP_INDEX "1"
		$TOOLNUMBER = "T806"
		IF $COMPANY == "Matrex" {
			CALL $MatrexToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSEIF $COMPANY == "Alumat" {
			CALL $AlumatToolsForDrilling($TOOLNUMBER , $NAME , $SPEED , $FEED , $PLUNGE)
		} ELSE {
			MESSAGE ERROR "Uknown Company"
		}
		ACTIVATE TOOL $NAME
		EDIT RPM $SPEED
		EDIT FRATE $FEED
		EDIT PRATE $PLUNGE
		ACTIVATE Featureset $SETNAME
		DIALOGS MESSAGE OFF
		DIALOGS ERROR OFF
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_1"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_2"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_3"
		EDIT FEATURESET $SETNAME SELECT "SPINE_POZZETO_D12_4"
		DIALOGS MESSAGE ON
		DIALOGS ERROR ON
		EDIT TOOLPATH "SPINE POZZETO D12 SMUSSO" CALCULATE
		DEACTIVATE Toolpath
		DEACTIVATE Tool
		DEACTIVATE Featureset
	} ELSE {
		
	}
}


